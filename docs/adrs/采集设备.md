# 数据采集与回放系统接口架构设计

## 1. 概述
本设计文档定义了一个抽象接口层（Interface/ABC），用于统一管理 **数据采集（ADC）** 与 **波形发射（DAC）** 功能。  
目标是提供标准化的接口，便于扩展和跨硬件适配。

---

## 2. 系统模块划分

### 2.1 Interface / ABC
- 定义通用接口标准。
- 作为所有模块（ADC、DAC）的抽象基类。

### 2.2 ADC（模数转换器）
- 用于数据采集。
- 支持多通道输入（Channel）。
- 提供采样、触发、数据获取等功能。

### 2.3  DAC（数模转换器）
- 用于信号输出与回放。
- 支持多通道输出（ch1、ch2）。
- 提供波形加载、播放控制、触发控制等功能。

### 2.4 需要实现上述接口的系统
- **NS**
- **EZQ**
- **ZWPX**

- 关于采集卡，我们目前不适用上述接口



---

## 3. 功能接口设计

### 3.1 ADC 接口
#### 通用方法
- `start_capture()`  
  启动数据采集。
- `get_data(ch)`  
  获取指定通道的采样数据。具体的数据格式需要看capture_mode

#### 配置方法
- `set_trigger_source(src)`  
  设置触发源。
- `set_sample_rate(rate)`  
  设置采样率。
- `set_record_length(length)`  
  设置采集长度。
- `set_capture_mode(mode)`  
  - 可选模式：`"demod"`, `"raw"`, `"GMM"` 等
- `set_shot(num)`  
  设置采集次数。

<!-- #### 进阶设置 -->
- `set_demod(ch, ...)`  
  设置解调配置。比如可以传递解模频率，或者直接写入解模参数
- `set_trigger_delay(delay)`  
  设置触发延时。
<!-- - `tags.xx.trigger`  
  标签化配置（待细化）。 -->

---

### 3.2 DAC 接口
#### 通用方法
- `start_play()`  
  启动信号播放。
- `reset()`  
  重置设备或者指定通道。

#### 配置方法
- `set_trigger_source()`  
  设置触发源。
- `set_sample_rate(rate)`  
  设置输出采样率。
- `set_waveform(ch, method = "arrray" | "function", value)`  
  设置输出波形及类型。
- `set_trigger_delay(delay)`  
  设置触发延时。

---

## 4. 模块关系图（逻辑）




## 5. 总结
该设计文档梳理了一个抽象的 **数据采集与波形发射系统接口**：

- **ADC**：负责采集 → 采样率、触发、数据模式等。
- **DAC**：负责输出 → 波形设置、播放、触发等。
- **统一接口**：通过抽象基类保证模块可扩展性。
- **扩展模块**：NS、EZQ、ZWPX 等系统需要实现上述接口。

本架构可作为硬件驱动层或实验控制平台的基础接口规范。